# Prefix
set-option -g prefix C-q
# デフォルトのPrefixを解除
unbind C-b
bind q send-prefix

### Options
# Zsh
set-option -g default-shell /bin/zsh
# 256色端末を使用する
set-option -g default-terminal screen-256color
# コピー・選択モードのキーバインドをviに
set-window-option -g mode-keys vi

# Vimのモード切り替えが重いので。
set -s escape-time 0

# Status ber
set-option -g status-interval 10

set-window-option -g mouse on

set-option -g renumber-windows on

set-option -g default-terminal "xterm"

set-option -g default-command "reattach-to-user-namespace -l zsh"

### Key bindings

# ペイン番号表示
bind i display-panes

# Reload conf
bind r source-file ~/.tmux.conf\; display-message "Reloaded."

# vimのキーバインドでペインを移動する
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# vimのキーバインドでペインをリサイズする
bind -r C-h resize-pane -L 5
bind -r C-j resize-pane -D 5
bind -r C-k resize-pane -U 5
bind -r C-l resize-pane -R 5

# 新しいペインを同一ディレクトリで開く
bind c new-window -c '#{pane_current_path}'
bind '"' split-window -c '#{pane_current_path}'
bind % split-window -h -c '#{pane_current_path}'

# zoom pane
bind y resize-pane -Z

# 選択パネルの強調
set -g window-status-current-style fg=cyan,bg=black,bold
set -g pane-active-border-style fg=colour247,bg=black

## http://qiita.com/upinetree/items/cd80bc7865c52091be10

# Use vim keybindings in copy mode
setw -g mode-keys vi
# Setup 'v' to begin selection as in Vim
bind-key -T copy-mode-vi v send-keys -X begin-selection

bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "reattach-to-user-namespace pbcopy"
# Update default binding of `Enter` to also use copy-pipe
unbind-key -T copy-mode-vi Enter
bind-key -T copy-mode-vi Enter send-keys -X copy-pipe "reattach-to-user-namespace pbcopy"

unbind-key -T copy-mode-vi C-v
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle

unbind-key -T copy-mode-vi [
bind-key -T copy-mode-vi [ send-keys -X begin-selection
unbind-key -T copy-mode-vi ]
bind-key -T copy-mode-vi ] send-keys -X copy-selection

# http://qiita.com/nyarla/items/034496c3a411d1deb484
set -g status-interval 0

# Plugins
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'
set -g @plugin 'tmux-plugins/tmux-cpu'
set -g @plugin 'gmoe/tmux-wifi'
set -g status-right '#{prefix_highlight} #{cpu_bg_color} CPU: #{cpu_icon} #{cpu_percentage} #{wifi_ssid} #{wifi_icon} | %a %h-%d %H:%M '
#set -g @plugin 'tmux-plugins/tmux-net-speed'
#set -g status-right '#{prefix_highlight} #{cpu_bg_color} CPU: #{cpu_icon} #{cpu_percentage} Network: #{net_speed} | %a %h-%d %H:%M '
set-option -g status-right-length 120

# TODO tmux-sensibleで設定済みの記述を削除する
set -g @plugin 'tmux-plugins/tmux-sensible'

set -g @plugin 'tmux-plugins/tmux-copycat'
# prefix + / - regex search (strings work too)
# prefix + ctrl-f - simple file search
# prefix + ctrl-g - jumping over git status files (best used after git status command)

# set -g @plugin 'tmux-plugins/tmux-sidebar'
# set -g @sidebar-tree-command 'exa -T -L 1 --git-ignore'
# set -g @sidebar-tree 'e'
# set -g @sidebar-tree-focus 'w'

set -g @plugin 'tmux-plugins/tmux-sessionist'
# prefix + g - prompts for session name and switches to it. Performs 'kind-of' name completion
# prefix + shift-c - prompt for creating a new session by name.
# prefix + shift-x - kill current session without detaching tmux.
# prefix + shift-s - switches to the last session.
# prefix + @ - promote current pane into a new session.
# prefix + t<secondary-key> - join currently marked pane (prefix + m) to current session/window, and switch to it
# secondary-keys
#   h, -, ": join horizontally
#   v, |, %: join vertically
#   f, @: join full screen

set -g @plugin 'jbnicolai/tmux-fpp'
# prefix + f - "fpp" for a new window with a Facebook PathPicker selection of your tty.

set -g @plugin 'tmux-plugins/tmux-open'
# In tmux copy mode:
#   prefix + o - "open" a highlighted selection with the system default program. open for OS X or xdg-open for Linux.
#   prefix + ctrl-o - open a highlighted selection with the $EDITOR
#   prefix + shift-s - search the highlighted selection directly inside a search engine (defaults to google).

set -g @plugin 'tmux-plugins/tmux-urlview'
# prefix + u - listing all urls on bottom pane
set -g @urlview-key 'u'

run -b '~/.tmux/plugins/tpm/tpm'
